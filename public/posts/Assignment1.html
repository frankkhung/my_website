


<table>
<tbody>
<tr class="odd">
<td>itle: “Assignment 1”</td>
</tr>
<tr class="even">
<td>uthor: “Chien-Che Hung”</td>
</tr>
<tr class="odd">
<td>ate: “9/19/2020”</td>
</tr>
<tr class="even">
<td>agetitle: “Assignment 1”</td>
</tr>
</tbody>
</table>
<pre class="r"><code>library(readxl)
library(ggplot2) 
library(tidyverse)</code></pre>
<pre><code>## ── Attaching packages ───────────────────────────────────────────────────────────────────────────────── tidyverse 1.3.0 ──</code></pre>
<pre><code>## ✓ tibble  3.0.3     ✓ dplyr   1.0.2
## ✓ tidyr   1.1.2     ✓ stringr 1.4.0
## ✓ readr   1.3.1     ✓ forcats 0.5.0
## ✓ purrr   0.3.4</code></pre>
<pre><code>## ── Conflicts ──────────────────────────────────────────────────────────────────────────────────── tidyverse_conflicts() ──
## x dplyr::filter() masks stats::filter()
## x dplyr::lag()    masks stats::lag()</code></pre>
<pre class="r"><code>library(forcats)
library(plyr)</code></pre>
<pre><code>## ------------------------------------------------------------------------------</code></pre>
<pre><code>## You have loaded plyr after dplyr - this is likely to cause problems.
## If you need functions from both plyr and dplyr, please load plyr first, then dplyr:
## library(plyr); library(dplyr)</code></pre>
<pre><code>## ------------------------------------------------------------------------------</code></pre>
<pre><code>## 
## Attaching package: &#39;plyr&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:dplyr&#39;:
## 
##     arrange, count, desc, failwith, id, mutate, rename, summarise,
##     summarize</code></pre>
<pre><code>## The following object is masked from &#39;package:purrr&#39;:
## 
##     compact</code></pre>
<pre class="r"><code>ttc_delay &lt;- read_xlsx(&quot;/Users/frankhung/Documents/FHDocument/2020_2021/STA304/Assignments/Assignment\ 1/ttc-streetcar-delay-data-2019.xlsx&quot;)</code></pre>
<pre class="r"><code>ggplot(ttc_delay, aes(x = forcats::fct_infreq(Day))) +
  geom_bar(stat = &quot;count&quot;) +
  theme_minimal()</code></pre>
<p><img src="/posts/Assignment1_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<pre class="r"><code>ggplot(ttc_delay, aes(x = forcats::fct_infreq(Incident))) +
  geom_bar(stat = &quot;count&quot;) +
  theme_minimal()</code></pre>
<p><img src="/posts/Assignment1_files/figure-html/unnamed-chunk-2-2.png" width="672" /></p>
<pre class="r"><code>aggregate(ttc_delay$`Min Delay`, by = list(ttc_delay$Incident), mean)</code></pre>
<pre><code>##                 Group.1         x
## 1             Diversion 21.142857
## 2    Emergency Services 10.880000
## 3         General Delay 11.040541
## 4               Held By        NA
## 5         Investigation 19.614213
## 6   Late Leaving Garage 14.119048
## 7            Mechanical        NA
## 8 Overhead - Pantograph  6.200000
## 9    Utilized Off Route  6.212121</code></pre>
<pre class="r"><code>delay_sum &lt;- as.data.frame(aggregate(`Min Delay` ~ Incident, ttc_delay, mean))


delay_sum$Incident &lt;- factor(delay_sum$Incident, levels = delay_sum$Incident[order(delay_sum$`Min Delay`, decreasing = TRUE)])

delay_sum %&gt;%
  ggplot(aes(x = Incident, y = `Min Delay`)) +
  geom_bar(stat = &quot;identity&quot;) + 
  labs(title = &quot;Average Delay Time According to Incidents&quot;) +
  theme_light() +
  theme(axis.text.x = element_text(angle = 60, vjust = 0.6, hjust=0.5))</code></pre>
<p><img src="/posts/Assignment1_files/figure-html/unnamed-chunk-2-3.png" width="672" /></p>
